{"version":3,"sources":["src/routes/router.js","src/main.js"],"names":["defaultRedirect","redirect","name","template","render","console","log","Router","routerArr","url","spliceHash","location","href","pathArr","map","k","path","filter","length","hashHistory","init","hashFn","bindEvent","currentRoute","element","hasIndex","window","hash","indexOf","component","call","e","document","querySelector","innerHTML","addEventListener","newURL","history","back","str","hashIndex","substr","arr","index","Array","isArray","module","exports","title","router"],"mappings":"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","file":"main.c42ec3ec.map","sourceRoot":"..","sourcesContent":["defaultRedirect = {\n  redirect: '/404',\n  name: '404',\n  template: `<div>404 not found</div>`,\n  render: () => {console.log('404 NOT FOUND');}\n};\n\n// TODO 实现异步请求数据渲染模版，渲染方法的设计及与外部传入配置component的结合\n// TODO 实现beforeEnter afterEnter beforeLeave afterLeave钩子\nclass Router {\n  constructor(routerArr) {\n    this.url = spliceHash(location.href);\n    this.routerArr = routerArr;\n    this.pathArr = routerArr.map(k => k.path);\n    this.redirect = routerArr.filter(k => (k.redirect)).length > 0 ? routerArr.filter(k => (k.redirect)) : [defaultRedirect];\n    this.hashHistory = [];\n    this.init();\n  }\n\n  init() {\n    this.hashFn(this.url);\n    this.bindEvent();\n  }\n\n  hashFn(url) {\n    let currentRoute, element;\n    if (!hasIndex(this.pathArr, url) && !(this.redirect[0].redirect === url)) {\n      window.location.hash = this.redirect[0].redirect;\n      return;\n    }\n    if (hasIndex(this.pathArr, url)) {\n      currentRoute = this.routerArr[(this.pathArr.indexOf(url))];\n      // element = currentRoute.template;\n    } else {\n      currentRoute = this.redirect[0];\n      // element = currentRoute.template;\n    }\n    try {\n      currentRoute.component.call(this);\n    } catch (e) {\n      console.log(e);\n    }\n    currentRoute.component()\n    // console.log('currentRoute==>>', currentRoute);\n\n    // console.log('before routerArr', this.routerArr);\n    // TODO 渲染和触发beforeRender的方法\n    // if (element) {\n    //   this.render(element);\n    // }\n    // if (currentRoute) {\n    //   currentRoute.beforeRender();\n    // }\n    // console.log('after routerArr', this.routerArr);\n\n  }\n\n  render(element) {\n    document.querySelector('body').innerHTML = element;\n  }\n\n  bindEvent() {\n    window.addEventListener('hashchange', (e) => {\n      const url = spliceHash(e.newURL);\n      this.hashFn(url);\n    });\n  }\n\n  // 跳转到路由\n  push(url) {\n    window.location.hash = url;\n  }\n\n  goBack() {\n    window.history.back();\n  }\n}\n\n\nfunction spliceHash(url) {\n  let str;\n  const hashIndex = url.indexOf('#');\n  if (hashIndex >= 0) {\n    str = url.substr(hashIndex + 1);\n  } else {\n    str = '/';\n  }\n  return str;\n}\n\nfunction hasIndex(arr, index) {\n  if (!Array.isArray(arr)) return false;\n  return arr.indexOf(index) >= 0;\n}\n\n\nmodule.exports = Router;","import Router from './routes/router';\n\nconst routerArr = [\n  {\n    path: '/',\n    name: 'index',\n    title: '主页',\n    // template: `<div>主页</div>`,\n    // beforeRender: function() {\n    //   this.template = `<div>哈哈哈</div>`;\n    // }\n    component:()=>{}\n  },\n  {\n    path: '/list',\n    name: 'list',\n    title: '列表',\n    // template: `<div>列表页</div>`,\n    // beforeRender: () => {console.log('render list');}\n  },\n  {\n    redirect: '/504',\n    name: '504',\n    // template: `<div>504 not found</div>`,\n    // beforeRender: () => {console.log('504 NOT FOUND');}\n  }];\n\nconst router = new Router(routerArr);"]}