{"version":3,"sources":["src/routes/router.js","src/main.js"],"names":["defaultRedirect","redirect","name","template","render","console","log","Router","routerArr","pathArr","map","k","path","filter","hashHistory","init","url","spliceHash","location","href","hashFn","bindEvent","currentRoute","element","hasIndex","indexOf","window","hash","document","querySelector","innerHTML","addEventListener","e","newURL","history","back","hashIndex","str","substr","arr","index","Array","isArray","module","exports","title","router"],"mappings":"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","file":"main.c42ec3ec.map","sourceRoot":"..","sourcesContent":["defaultRedirect = {\n  redirect: '/404',\n  name: '404',\n  template: `<div>404 not found</div>`,\n  render: () => {console.log('404 NOT FOUND');}\n};\n\nclass Router {\n  constructor(routerArr) {\n    this.routerArr = routerArr;\n    this.pathArr = routerArr.map(k => k.path);\n    this.redirect = routerArr.filter(k => (k.redirect));\n    this.hashHistory = [];\n    this.init();\n  }\n\n  init() {\n    const url = spliceHash(location.href);\n    this.hashFn(url);\n    this.bindEvent();\n  }\n\n  hashFn(url) {\n    let currentRoute, element;\n    if (hasIndex(this.pathArr, url)) {\n      currentRoute = this.routerArr[(this.pathArr.indexOf(url))];\n    } else {\n      // 重定向到默认\n      currentRoute = this.redirect[0];\n      if (!currentRoute) {\n        currentRoute = defaultRedirect;\n      }\n      // todo 两次触发404 render的问题\n      window.location.hash = currentRoute.redirect;\n    }\n    element = currentRoute.template;\n    // 渲染dom\n    document.querySelector('body').innerHTML = element;\n    // 触发render钩子\n    if (currentRoute.render) currentRoute.render();\n  }\n\n  bindEvent() {\n    window.addEventListener('hashchange', (e) => {\n      const url = spliceHash(e.newURL);\n      this.hashFn(url);\n      // let currentRoute, element;\n      // if (hasIndex(this.pathArr, url)) {\n      //   currentRoute = this.routerArr[(this.pathArr.indexOf(url))];\n      // } else {\n      //   // 重定向到默认\n      //   currentRoute = this.redirect[0];\n      //   if (!currentRoute) {\n      //     currentRoute = defaultRedirect;\n      //   }\n      //   // todo 两次触发404 render的问题\n      //   window.location.hash = currentRoute.redirect;\n      // }\n      // element = currentRoute.template;\n      // // 渲染dom\n      // document.querySelector('body').innerHTML = element;\n      // // 触发render钩子\n      // if (currentRoute.render) currentRoute.render();\n\n    });\n  }\n\n  // 跳转到路由\n  push(url) {\n    window.location.hash = url;\n  }\n\n  goBack() {\n    window.history.back();\n  }\n}\n\n\nfunction spliceHash(url) {\n  const hashIndex = url.indexOf('#');\n  const str = url.substr(hashIndex + 1);\n  return str;\n}\n\nfunction hasIndex(arr, index) {\n  if (!Array.isArray(arr)) return;\n  return arr.indexOf(index) >= 0;\n}\n\n\nmodule.exports = Router;","import Router from './routes/router';\n\nconst routerArr = [\n  {\n    path: '/',\n    name: 'index',\n    title: '主页',\n    template: `<div>主页</div>`,\n    render: () => {console.log('render index');}\n  },\n  {\n    path: '/list',\n    name: 'list',\n    title: '列表',\n    template: `<div>列表页</div>`,\n    render: () => {console.log('render list');}\n  }];\n\nconst router = new Router(routerArr);"]}